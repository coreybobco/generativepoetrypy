language: python

python:
  - "3.6"

matrix:
  include:
    - python: 3.7
      os: linux
      dist: bionic
    - python: 3.6
      os: linux
      dist: bionic
    - os: osx
      language: generic
      env: PYTHON=37
    - os: osx
      language: generic
      env: PYTHON=36

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
    brew install swig;
    curl -LO https://raw.githubusercontent.com/GiovanniBussi/macports-ci/master/macports-ci;
    source ./macports-ci install;
    fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
    yes | sudo port install python$PYTHON;
    yes | sudo port install py$PYTHON-pip;
    sudo port select --set python3 python$PYTHON;
    sudo port select --set pip pip$PYTHON;
    pip install pyinstaller --user;
    export PATH=$PATH:/Users/travis/Library/Python/$PYTHON/bin;
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update          ; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install hunspell; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt install -y libhunspell-dev hunspell-en-us; fi

install:
  - pip install -r requirements.txt
  - pip install coverage

script:
  - coverage run --source generativepoetry setup.py test --verbose

after_success:
  - pip install coveralls
  - coveralls  # send coverage to coveralls.io

after_script:
  - coverage report                     # display coverage report on command line
  - pip install pycodestyle pyflakes
  - pyflakes . | tee >(wc -l)           # static analysis
  - pycodestyle --statistics --count .  # static analysis